{
  "hash": "35828192c6e9a536b0bfc3fffd0ecc77",
  "result": {
    "markdown": "---\ntitle: 'BEE 4750 Homework 3: Dissolved Oxygen'\nformat:\n  html:\n    warning: true\n    error: true\n  ipynb:\n    warning: true\n    error: true\n    code-annotation: below\nformat-links: []\n---\n\n::: {.content-visible when-format=\"ipynb\"}\n**Name**:\n\n**ID**:\n:::\n\n::: {.callout-important icon=false}\n### Due Date\n\nFriday, 10/06/23, 9:00pm\n:::\n\n::: {.content-visible when-format=\"html\"}\n\n:::{.callout-caution}\n\nIf you are enrolled in the course, make sure that you use the GitHub Classroom link provided in Ed Discussion, or you may not be able to get help if you run into problems.\n\nOtherwise, you can [find the Github repository here]({{< var github_org.repo >}}/hw03).\n\n:::\n\n:::\n\n## Overview\n\n### Instructions\n\n- Problems 1-3 consist of a series of code snippets for you to interpret and debug. For Problems 1 and 2, you will be asked to identify relevant error(s) and fix the code. For Problem 3, the code works as intended; your goal is to identify the code's purpose by following its logic.\n- Problem 4 asks you to convert a verbal description of a wastewater treatment system into a Julia function, and then to use that function to explore the impact of different wastewater allocation strategies.\n\n### Load Environment\n\nThe following code loads the environment and makes sure all needed packages are installed. This should be at the start of most Julia scripts.\n\n::: {#dc4bc787 .cell execution_count=1}\n``` {.julia .cell-code}\nimport Pkg\nPkg.activate(@__DIR__)\nPkg.instantiate()\n```\n:::\n\n\n::: {#65f119b3 .cell execution_count=2}\n``` {.julia .cell-code}\nusing Plots\nusing LaTeXStrings\nusing Distributions\nusing PDMats\n```\n:::\n\n\n## Problems (Total: 100 Points)\n\n::: {.cell .markdown}\n### Problem 1 (60 points)\n\nA river which flows at 6 km/d is receiving waste discharges from two sources which are 15 km apart, as shown in @fig-river. The oxygen reaeration rate is 0.55 day^-1^, and the decay rates of CBOD and NBOD are are 0.55 and 0.25 day^-1^, respectively. The river's saturated dissolved oxygen concentration is 10m g/L.\n\n![Schematic of the system in Problem 1](figures/river_diagram.png){#fig-river}\n\n:::\n\n::: {.cell .markdown}\n\n#### Problem 1.1 (20 points)\n\nIf the characteristics of the river inflow and waste discharges are given in @tbl-river, plot the dissolved oxygen concentration in the river from the first waste stream to 50km downstream.\n\n| Parameter | River Inflow | Waste Stream 1 | Waste Stream 2 |\n|:---------:|-------------:|---------------:|---------------:|\n| Inflow | 100,000 m^3^/d | 10,000 m^3^/d | 15,000 m^3^/d |\n| DO Concentration | 7.5 mg/L | 5 mg/L | 5 mg/L |\n| CBOD | 5 mg/L | 50 mg/L | 45 mg/L |\n| NBOD | 5 mg/L | 35 mg/L | 35 mg/L |\n: River inflow and waste stream characteristics for Problem 1. {#tbl-river}\n\n:::\n\n::: {.cell .markdown}\n#### Problem 1.2 (10 points)\n\nUnder the assumptions of Problem 1.1, determine the distance from waste stream 2 it will take for the dissolved oxygen concentration of the river to recover to 6 mg/L.\n:::\n\n::: {.cell .markdown}\n#### Problem 1.3 (10 points)\n\nWhat is the minimum level of treatment (% removal of organic waste) for waste stream 2 that will ensure that the dissolved oxygen concentration never drops below 4 mg/L, assuming that waste stream 1 remains untreated?\n:::\n\n::: {.cell .markdown}\n#### Problem 1.4 (10 points)\n\nIf both waste streams are treated equally, what is the minimum level of treatment (% removal of organic waste) for the two sources required to ensure that the dissolved oxygen concentration never drops below 4 mg/L?\n\n:::\n\n::: {.cell .markdown}\n\n#### Problem 1.5 (10 points)\n\nSuppose you are responsible for designing a waste treatment plan for discharges into the river, with a regulatory mandate to keep the dissolved oxygen concentration above 4 mg/L. Discuss whether you'd opt to treat waste stream 2 alone or both waste streams equally. What other information might you need to make a conclusion, if any?\n\n:::\n\n::: {.cell .markdown}\n### Problem 2 (40 points)\n:::\n\n::: {.cell .markdown}\n#### Problem 2.1 (15 points)\n\nSuppose now that the CBOD and NBOD values of the river inflow are uncertain. Suppose that your estimates of CBOD vary uniformly between 4 mg/L and 7 mg/L, and NBOD estimates vary uniformly between 3 mg/L and 8 mg/L. \n\nIf you assume these values are independent, what is the probability that the strategy you selected in Problem 1.5 will fail to keep the dissolved oxygen concentration above 4 mg/L? How did you decide how many samples to use to determine this probability?\n:::\n\n::: {.cell .markdown}\n#### Problem 2.2 (15 points)\n\nNow suppose that CBOD and NBOD values are correlated: specifically, they have a correlation coefficient of 0.7. How does that impact the probability of maintaining a dissolved oxygen concentration above 4 mg/L under the treatment strategy you selected in Problem 1.5? How did you decide how many samples to use to determine this probability?\n\nYou can use the `sample_correlated_uniform()` function defined below to produce correlated uniform samples. \n:::\n\n::: {#4c43c70b .cell execution_count=3}\n``` {.julia .cell-code}\n# This function samples n correlated variates distributed over \n# Uniform(a[1], a[2]) and Uniform(b[1], b[2]) with correlation coefficient\n# corr_coef. The bounds on each uniform distribution should be passed as a vector\n# or a tuple.\nfunction sample_correlated_uniform(n, a, b, corr_coef=0.7)\n    # set up a multivariate normal with each marginal variance of 1 \n    # and the right correlation\n    mvnorm = MvNormal([0, 0], PDMat([1 corr_coef; corr_coef 1])) \n    # sample from the multivariate normal, the marginal distributions \n    # are a standard normal\n    norm_samples = rand(mvnorm, n)' \n    # convert samples to a uniform distribution using the pdf of a standard Normal\n    unif_samples = cdf.(Normal(0, 1), norm_samples) \n    # transform the samples to have the right range\n    samples = (unif_samples .* [a[2] - a[1] b[2] - b[1]]) .+ [a[1] b[1]]\n    return samples\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\nsample_correlated_uniform (generic function with 2 methods)\n```\n:::\n:::\n\n\n::: {.cell .markdown}\n#### Problem 2.3 (10 points)\n\nDiscuss how the presence of uncertainty and dependence between variables might affect your decision-making process. Does the impact of the correlation between the CBOD and NBOD inputs in Problem 2.2 make sense to you? Would you stick with the same strategy as Problem 1.5? What other information might you need to make this assessment, if any? \n:::\n\n::: {.cell .markdown}\n## References\n\nList any external references consulted, including classmates.\n:::\n\n",
    "supporting": [
      "hw03_files"
    ],
    "filters": [],
    "includes": {}
  }
}